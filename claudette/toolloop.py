# AUTOGENERATED! DO NOT EDIT! File to edit: ../02_toolloop.ipynb.

# %% auto 0
__all__ = []

# %% ../02_toolloop.ipynb 3
from .core import *
from fastcore.utils import *

# %% ../02_toolloop.ipynb 19
@patch
def toolloop(self:Chat,
             pr, # Prompt to pass to Claude
             max_steps=10, # Maximum number of tool requests to loop through
             temp=0, # Temperature
             maxtok=4096, # Maximum tokens
             stop:Optional[list[str]]=None, # Stop sequences
             show_trace:bool=False, # Print tool use steps
             **kw):
    "Add prompt `pr` to dialog and get a response from Claude, automatically following up with `tool_use` messages"
    r = self(pr, temp=temp, maxtok=maxtok, stop=stop, **kw)
    i=0
    while r.stop_reason=='tool_use' and i<max_steps:
        if show_trace: print(r)
        r = self(r, temp=temp, maxtok=maxtok, stop=stop, **kw)
        i += 1
    if show_trace: print(r)
    return r
